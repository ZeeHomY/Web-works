## 数据交互

### 一、

1. http
2. form  // 所有的数据交互其实都是form
3. AJAX   // 官方提供，不能跨域。 起初不用他来跨域，使用jsonp跨域，之后发现可以使用ajax跨域  （单向）
4. jsonp   // 民间，可以跨域。  破坏了http 本身的安全设计。  【另】不支持post
5. websocket（和H5一起出现）双工 可由客户端向服务器发出请求，也可由服务器主动向浏览器发送响应。
   如果用每隔一定时间发送一次请求解决：
   1. 浪费很多流量，发送很多无用的请求（尤其移动端流量费用）
   2. 系统性能问题，服务端会接受太多太频繁的请求

### http协议 （www.letf.org/rfc/rfc2616.txt）

服务端（服务器） eg. apache、nginx、IIS等

1. 出于简单考虑 是无状态的 （不会记住用户）
2. 连接过程
  1.  ——连接——>
  2.  <——接受（/拒接）——        // 如负载太高等，会拒绝
  3. ——请求内容——>

【引】前端避免http缓存方法
1. 加随机数
2. 响应头cache-control、Date、Expires 请求最新的内容

【引】https
1. s：scryti 安全的
2. 基于非对称加密（公钥私钥结构）
    可以方便地计算两个数相乘的积，但不容易将一个大数进行因数分解，需要很长时间。

    公钥对外发送，很大；私钥自留，很小
    别人用公钥算出大数，自己拿到后，只有用私钥能解开。（生成证书的时候会得到公钥）
3. 证书 证明自己身份
  1. 自验证的证书
  2. 第三方颁发机构颁发的（多数）

【引】http版本
- 1.0  短连结  会导致文档内容请求反复连接断开
- 1.1 主流  长链接（keep-alive）
- 2.0 最近（三五年）流行需20年左右。试图在应用层协议加入状态

使用版本由浏览器请求决定以同样版本返回，但2.0中有websocket可有服务器主动发送消息

3. 数据体：消息、报文、帧。。。

  双向数据都为header-body（content）型，http协议为此，其他协议不一定

  header <= 32K (协议规定，也与Int类型有关)
  多为存放一条一条信息

  body <= 2G, 有效载荷1G（因为协议、浏览器等原因，极限为2G）
  多为存放数据
  两大种格式

  chrome--network:
  Headers:
  Request Headers 请求头
  Response Headers 响应头

### form 重要 客户端向服务端请求数据的唯一实质方式
ajax、jsonp都为对form的模封装，只是不用刷新页面了
http协议规定浏览器只能向服务器发送一种数据：表单数据

1. action:提交的地址
2. method：决定提交的方法
    - GET/POST/PUT/DELETE/HEAD
    - 可以自定义方法：method="custom"
      但需在服务器上配置
  GET 数据在url中         // inupt的name属性区分数据名
      但Header本身小，且已有Accept-Encoding、Accept-Language、Cache-Control等数据，所以能用部分很小
      有效载荷10K左右
      会缓存
      <= 32K(20+K可用)

  POST及其他方式：都不会放在URL中，都放在body中
      能用1G（因为绝大部分服务器对协议的实现是错误的）
      更大的可用其他协议（如客户端软件上传视频5G+，走TCP协议，无大小限制，支持断点续传）
      不会缓存
      <= 1G

  GET：获取数据 不用发送很多数据
  POST、PUT：发送数据
  DELETE：删除 发送少量数据
  HEAD：告诉服务器只发送头回来，不需要内容。检测服务器是否活动，响应时间是多少等。

3. input name 数据名

4. enctype(encoding type)
  可以自定义，要和服务器定好。
  application/x-www-form-urlencoded：最常见,名字=值&名字=值，post方式也能用。默认值。不能发送大量的数据，无法上传文件
  multipart/form-data：上传文件。分块，上传大量数据（最大1G）
  text/plain: 纯文本（很少用）

【引】header结构 按“行”携带数据（请求头）
第一行 GET（请求方式） /post/prevnext?postId=429445（url） HTTP/1.1（协议版本）

## ajax原理 XMLHttpRequest（IE6及其以下不兼容）
对表单的模拟
- 用户体验好，局部刷新
- 性能消耗少，减少了请求整个页面需要完成的工作（下载渲染）

后台会被同时几千几百的请求，so一个动作会被放大几百倍

3. status

    * 1xx 消息
    * 3XX重定向
      - 301：
      - 302
      - 303:
      - 304: not modified 没有修改（使用原来的（缓存））
          - 第一次：200、内容、expires 有效期
          - 第二次：会详说
          - 三：日期（第一次得到的时间）
              返回：304:在这个时间后这个文件没有改动。 内容null
                   200 过期了。另加+内容

          客户端控制不使用缓存：在第二次请求时（HEAD）中不带date
          服务端控制：服务器取到date后，无论什么时间后返回最新的
    * 4xx 请求错误
    * 5xx 服务段错误
    * 6xx+自定义


    成功：2XX、304


4. eval(); // 可能会运行到非预期代卖。
5.
6. 安全：
   1. 前台没有类似数据的安全问题，后端有
   2. xss：跨站脚本攻击
      1. dns污染（eg。由运营商造成）
      2. 自己造成。
         ajax不允许跨域。是为了防止xss。若可以，会拿来直接用（可能会带有非预期的内容）
